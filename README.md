# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура

Приложение реализовано по MVP архитектуре и состоит из компонентов:

| Компонент | Описание | Базовый класс | Связанные классы |
|-----------|-----------|--------------|-----------------|
| Model | Модель данных | Model | - Product<br>- Cart<br>- Order |
| View | Модель отображения | Component | - ProductListView<br>- ProductView<br>- CartView<br>- OrderView<br>- DeliveryForm<br>- ContactsForm<br>- Success |
| Presenter | Модель связи | - | - AppPresenter<br>- CartPresenter<br>- OrderPresenter |

![architecture.png](architecture.png)

## Базовые классы

### EventEmitter
Реализует паттерн «Наблюдатель». Методы:
- `on`: подписка на событие
- `off`: отписка от события
- `emit`: уведомление подписчиков
- `onAll`: подписка на все события
- `offAll`: сброс всех подписчиков

### Component
Абстрактный базовый класс для всех представлений, который принимает дженерик Component<T>. Реализует методы для работы с DOM:
- Управление классами элементов
- Установка текстового содержимого
- Управление атрибутами

### Model
Абстрактный базовый класс для моделей данных, который принимает дженерик Model<T>:
- Связывает данные со свойствами объекта
- Инициализирует события при изменении данных

### APIClient
Базовый класс для работы с API:
- GET-запросы для получения данных
- POST-запросы для отправки данных

## Компоненты моделей

### AppState
Основная модель приложения:
- Хранит массив всех доступных товаров
- Хранит текущий товар для показа в модальном окне
- Управляет состоянием приложения
- Генерирует события при изменении данных


### Cart
Класс корзины:
- Управляет списком товаров
- Рассчитывает общую стоимость
- Методы: add, remove, clear

### Order
Класс заказа:
- Хранит данные: payment, email, phone, address, items
- Валидирует поля формы
- Генерирует события об ошибках валидации
- Отправляет заказ на сервер

## Компоненты представления

### Modal
Компонент модального окна:
- Отвечает за открытие и закрытие модального окна
- Управляет отображением контента через свойство content

### ProductListView
- Отображает каталог товаров
- Создает карточки товаров

### ProductView
- Отображает детальную информацию о товаре
- Генерирует события при взаимодействии пользователя

### CartView
- Отображает содержимое корзины
- Показывает общую стоимость
- Генерирует события при удалении товаров

### OrderView
- Отображает формы оформления заказа
- Генерирует события при отправке формы
- Отображает результат успешной отправки
- Показывает ошибки при заполнении форм

## API
Методы API:
- `getProducts`: получение списка товаров
- `getProduct`: получение информации о товаре
- `createOrder`: создание заказа

## Интерфейсы форм
- `TDeliveryForm` - тип формы доставки (payment, address)
- `TContactsForm` - тип формы контактов (email, phone)
- `IFormErrors` - интерфейс для ошибок валидации форм

## События
- `catalog:changed` - обновление каталога
- `card:open` - открытие карточки товара
- `basket:open` - открытие корзины
- `formErrors:changed` - валидация формы заказа
- `order_delivery:open` - открытие формы доставки
- `delivery:submit` - отправка формы доставки
- `order_contacts:open` - открытие формы контактов
- `contacts:submit` - отправка формы контактов
- `order:post` - отправка заказа
- `payment:changed` - выбор способа оплаты
- `delivery.address:change` - изменение адреса доставки
- `contacts.email:change` - изменение email
- `contacts.phone:change` - изменение телефона
- `modal:open` - открытие модального окна
- `modal:close` - закрытие модального окна